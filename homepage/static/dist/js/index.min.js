(()=>{"use strict";var e=function(){function e(e){this.threeLink=e}return e.prototype.load=function(){return e=this,t=void 0,r=function(){var e=this;return function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(o){return function(l){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}}(this,(function(t){return[2,new Promise((function(t,n){var r=e.threeLink.getAttribute("data-id");void 0===r&&n(new Error("The link element has to supply a data-id attribute!"));var i=e.threeLink.getAttribute("href");void 0===i&&n(new Error("The link element has to supply a href attribute!"));var o=document.getElementById(r);null===o?((o=document.createElement("script")).onload=function(){t(o)},o.id=r,o.src=i,e.threeLink.parentNode.insertBefore(o,e.threeLink.nextSibling)):t(o)}))]}))},new((n=void 0)||(n=Promise))((function(i,o){function a(e){try{s(r.next(e))}catch(e){o(e)}}function l(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,l)}s((r=r.apply(e,t||[])).next())}));var e,t,n,r},e}(),t=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{s(r.next(e))}catch(e){o(e)}}function l(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,l)}s((r=r.apply(e,t||[])).next())}))},n=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(o){return function(l){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}},r=function(){function e(e){this.imageElement=e}return e.prototype.loadTextureBehindAttribute=function(e){return t(this,void 0,void 0,(function(){var t=this;return n(this,(function(n){return[2,new Promise((function(n,r){var i=t.imageElement.getAttribute(e);if(null!==i)var o=(new THREE.TextureLoader).load(i,(function(){console.log("Loaded image resource "+i),n(o)}));else r(new Error('\n                    The image element must include\n                    an attribute "'+e+'"!\n                '))}))]}))}))},e.prototype.load=function(){return t(this,void 0,void 0,(function(){var e,t,r,o,a,l,s,u,c,h,d;return n(this,(function(n){switch(n.label){case 0:return void 0!==this.parallaxScene?[2]:(e=this.imageElement.clientWidth,t=this.imageElement.clientHeight,(r=new THREE.PerspectiveCamera(45,e/t,1,1e3)).position.z=200,[4,this.loadTextureBehindAttribute("src")]);case 1:return o=n.sent(),[4,this.loadTextureBehindAttribute("data-parallax-depth-map")];case 2:return a=n.sent(),(l=new THREE.WebGLRenderer({antialias:!0,alpha:!0})).setSize(e,t),s=l.domElement,u=new THREE.ShaderMaterial({uniforms:{mouseX:{value:0},mouseY:{value:0},scrollOffset:{value:0},texture:{value:o},depthTexture:{value:a}},vertexShader:"\n    varying vec2 vUv;\n\n    void main()\t{\n        vUv = uv;\n        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n    }\n",fragmentShader:"\n    #extension GL_OES_standard_derivatives : enable\n    varying vec2 vUv;\n    uniform float mouseX;\n    uniform float mouseY;\n    uniform float scrollOffset;\n    uniform sampler2D depthTexture;\n    uniform sampler2D texture;\n    void main() {\n        vec2 vMouse = vec2(mouseX, mouseY);\n        vec2 vScrollOffset = vec2(0, scrollOffset);\n        float depth = texture2D(depthTexture, vUv).r;\n        gl_FragColor = texture2D(\n            texture, vUv + vMouse * (depth) + vScrollOffset\n        );\n        // Do some edge anti aliasing, because the image\n        // may contain a premultiplied alpha channel.\n        gl_FragColor.rgb = gl_FragColor.rgb * gl_FragColor.a;\n    }\n"}),c=new THREE.Scene,h=new THREE.PlaneBufferGeometry(1,1),d=new THREE.Mesh(h,u),c.add(d),this.parallaxScene=new i(this.imageElement,s,r,l,o,a,u,c,h,d),[2]}}))}))},e.prototype.show=function(){var e;null===(e=this.parallaxScene)||void 0===e||e.show()},e.prototype.hide=function(){var e;null===(e=this.parallaxScene)||void 0===e||e.hide()},e}(),i=function(){function e(e,t,n,r,i,o,a,l,s,u){this.image=e,this.canvas=t,this.camera=n,this.renderer=r,this.diffuseTextureLoader=i,this.depthTextureLoader=o,this.shaderMaterial=a,this.scene=l,this.geometry=s,this.mesh=u}return e.prototype.requestAnimationFrame=function(){var e=this;window.requestAnimationFrame((function(){e.renderer.render(e.scene,e.camera)}))},e.prototype.updateViewportAspectRatio=function(){this.camera.aspect=this.image.naturalWidth/this.image.naturalHeight,this.camera.updateProjectionMatrix();var e=THREE.Math.degToRad(this.camera.fov),t=2*Math.tan(e/2)*this.camera.position.z,n=t,r=t*(this.image.naturalHeight/this.image.naturalWidth);this.mesh.scale.set(r,n,1),this.requestAnimationFrame()},e.prototype.reactToMouseMove=function(e){var t=this.canvas.getBoundingClientRect(),n=Math.max(-500,Math.min(500,e.clientX-t.left)),r=Math.max(-500,Math.min(500,e.clientY-t.top));this.shaderMaterial.uniforms.mouseX.value=-n/15e3,this.shaderMaterial.uniforms.mouseY.value=r/15e3,this.canvas.style.transform="rotate3d(0, 1, 1, "+n/50+"deg)",this.requestAnimationFrame()},e.prototype.show=function(){this.canvas.style.display="block",this.image.style.display="none",null===this.canvas.parentNode&&(this.image.parentNode.insertBefore(this.canvas,this.image.nextSibling),this.renderer.setSize(this.canvas.clientWidth,this.canvas.clientHeight)),window.addEventListener("resize",this.updateViewportAspectRatio.bind(this),!0),document.addEventListener("mousemove",this.reactToMouseMove.bind(this),!0),this.updateViewportAspectRatio(),this.requestAnimationFrame()},e.prototype.hide=function(){this.image.style.display="block",this.canvas.style.display="none",window.removeEventListener("resize",this.updateViewportAspectRatio.bind(this),!0),document.removeEventListener("mousemove",this.reactToMouseMove.bind(this),!0)},e}(),o=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{s(r.next(e))}catch(e){o(e)}}function l(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,l)}s((r=r.apply(e,t||[])).next())}))},a=function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(o){return function(l){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}};document.addEventListener("DOMContentLoaded",(function(){return o(void 0,void 0,void 0,(function(){var t,n,i,l,s;return a(this,(function(u){switch(u.label){case 0:return t=document.querySelector('link[rel="parallax-three-js"]'),n=new e(t),i=document.querySelectorAll("img.parallax"),l=Array.from(i).map((function(e){return new r(e)})),[4,(s=function(){return o(void 0,void 0,void 0,(function(){var e,t,r,i,o;return a(this,(function(a){switch(a.label){case 0:if(!(document.documentElement.clientWidth<1023))return[3,1];for(e=0,t=l;e<t.length;e++)o=t[e],console.log("Hiding parallax image..."),o.hide();return[3,6];case 1:return console.log("Loading THREE.js..."),[4,n.load()];case 2:a.sent(),r=0,i=l,a.label=3;case 3:return r<i.length?(o=i[r],console.log("Loading parallax image..."),[4,o.load()]):[3,6];case 4:a.sent(),console.log("Showing parallax image..."),o.show(),a.label=5;case 5:return r++,[3,3];case 6:return[2]}}))}))})()];case 1:return u.sent(),window.addEventListener("resize",s,!1),[2]}}))}))}))})(),document.addEventListener("DOMContentLoaded",(function(e){var t=document.getElementById("macbook-container"),n=document.getElementById("macbook-code-container"),r=document.getElementById("peerbridge-animation-preview"),i=document.getElementById("peerbridge-animation"),o=i.getContext("2d"),a=i.width*(2541/2225);i.height=a;var l=new Image;function s(e){return"/static/img/peerbridge-animation/animation-1000_"+e+".webp"}l.onload=function(){o.clearRect(0,0,i.width,i.height),o.drawImage(l,0,0,l.width,l.height,0,0,i.width,i.height)};var u=!1;function c(){var e=i.getBoundingClientRect(),t=1-(e.y+window.innerHeight)/(e.height+window.innerHeight);if(!(t>1||t<0)){if(!u){for(var n=function(e){new Promise((function(t){var n=new Image;n.onload=t,n.onerror=t,n.src=s(e)}))},r=38;r<=120;r++)n(r);u=!0}var o=38+Math.round(82*t);l.src=s(o)}}function h(){var e=t.getBoundingClientRect(),r=1-(e.y+window.innerHeight)/(e.height+window.innerHeight);r>1||r<0||(n.scrollTop=1e3*r)}function d(){document.documentElement.clientWidth<1023?(i.style.display="none",r.style.display="block",window.removeEventListener("scroll",c,!0),window.removeEventListener("scroll",h,!0)):(r.style.display="none",i.style.display="block",c(),window.addEventListener("scroll",c,!0),h(),window.addEventListener("scroll",h,!0))}d(),window.addEventListener("resize",d,!1)}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9ob21lcGFnZS8uL2hvbWVwYWdlL3N0YXRpYy9zcmMvdHMvcGFyYWxsYXgvbG9hZGVyLnRzIiwid2VicGFjazovL2hvbWVwYWdlLy4vaG9tZXBhZ2Uvc3RhdGljL3NyYy90cy9wYXJhbGxheC9pbWFnZS50cyIsIndlYnBhY2s6Ly9ob21lcGFnZS8uL2hvbWVwYWdlL3N0YXRpYy9zcmMvdHMvcGFyYWxsYXgvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vaG9tZXBhZ2UvLi9ob21lcGFnZS9zdGF0aWMvc3JjL3RzL2FwcHMudHMiXSwibmFtZXMiOlsidGhyZWVMaW5rIiwidGhpcyIsImxvYWQiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsImlkIiwiZ2V0QXR0cmlidXRlIiwidW5kZWZpbmVkIiwiRXJyb3IiLCJocmVmIiwidGhyZWVFbGVtZW50IiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImNyZWF0ZUVsZW1lbnQiLCJvbmxvYWQiLCJzcmMiLCJwYXJlbnROb2RlIiwiaW5zZXJ0QmVmb3JlIiwibmV4dFNpYmxpbmciLCJpbWFnZUVsZW1lbnQiLCJsb2FkVGV4dHVyZUJlaGluZEF0dHJpYnV0ZSIsImF0dHJpYnV0ZSIsInRleHR1cmVMb2FkZXIiLCJUSFJFRSIsIlRleHR1cmVMb2FkZXIiLCJjb25zb2xlIiwibG9nIiwicGFyYWxsYXhTY2VuZSIsIndpZHRoIiwiY2xpZW50V2lkdGgiLCJoZWlnaHQiLCJjbGllbnRIZWlnaHQiLCJjYW1lcmEiLCJQZXJzcGVjdGl2ZUNhbWVyYSIsInBvc2l0aW9uIiwieiIsImRpZmZ1c2VUZXh0dXJlTG9hZGVyIiwiZGVwdGhUZXh0dXJlTG9hZGVyIiwicmVuZGVyZXIiLCJXZWJHTFJlbmRlcmVyIiwiYW50aWFsaWFzIiwiYWxwaGEiLCJzZXRTaXplIiwiY2FudmFzIiwiZG9tRWxlbWVudCIsInNoYWRlck1hdGVyaWFsIiwiU2hhZGVyTWF0ZXJpYWwiLCJ1bmlmb3JtcyIsIm1vdXNlWCIsInZhbHVlIiwibW91c2VZIiwic2Nyb2xsT2Zmc2V0IiwidGV4dHVyZSIsImRlcHRoVGV4dHVyZSIsInZlcnRleFNoYWRlciIsImZyYWdtZW50U2hhZGVyIiwic2NlbmUiLCJTY2VuZSIsImdlb21ldHJ5IiwiUGxhbmVCdWZmZXJHZW9tZXRyeSIsIm1lc2giLCJNZXNoIiwiYWRkIiwiUGFyYWxsYXhTY2VuZSIsInNob3ciLCJoaWRlIiwiaW1hZ2UiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJ3aW5kb3ciLCJyZW5kZXIiLCJ1cGRhdGVWaWV3cG9ydEFzcGVjdFJhdGlvIiwiYXNwZWN0IiwibmF0dXJhbFdpZHRoIiwibmF0dXJhbEhlaWdodCIsInVwZGF0ZVByb2plY3Rpb25NYXRyaXgiLCJ2Rk9WIiwiTWF0aCIsImRlZ1RvUmFkIiwiZm92IiwibWF4SGVpZ2h0IiwidGFuIiwic2NhbGUiLCJzZXQiLCJyZWFjdFRvTW91c2VNb3ZlIiwiZXZlbnQiLCJyZWN0IiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0IiwieCIsIm1heCIsIm1pbiIsImNsaWVudFgiLCJsZWZ0IiwieSIsImNsaWVudFkiLCJ0b3AiLCJzdHlsZSIsInRyYW5zZm9ybSIsImRpc3BsYXkiLCJhZGRFdmVudExpc3RlbmVyIiwiYmluZCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJxdWVyeVNlbGVjdG9yIiwidGhyZWVMb2FkZXIiLCJUaHJlZUxvYWRlciIsInBhcmFsbGF4SW1hZ2VFbGVtZW50cyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJwYXJhbGxheEltYWdlcyIsIkFycmF5IiwiZnJvbSIsIm1hcCIsImVsZW1lbnQiLCJQYXJhbGxheEltYWdlIiwidXBkYXRlV2luZG93RGltZW5zaW9ucyIsImRvY3VtZW50RWxlbWVudCIsInBhcmFsbGF4SW1hZ2UiLCJtYWNib29rQ29udGFpbmVyIiwibWFjYm9va0NvZGVDb250YWluZXIiLCJwcmV2aWV3IiwiY3R4IiwiZ2V0Q29udGV4dCIsImZyYW1lIiwiSW1hZ2UiLCJmcmFtZVVSTCIsImluZGV4IiwiY2xlYXJSZWN0IiwiZHJhd0ltYWdlIiwiaGFzUHJlbG9hZGVkRnJhbWVzIiwidXBkYXRlQ3VycmVudFBlZXJicmlkZ2VGcmFtZSIsInByb2dyZXNzIiwiaW5uZXJIZWlnaHQiLCJpIiwiciIsIm9uZXJyb3IiLCJmcmFtZUluZGV4Iiwicm91bmQiLCJ1cGRhdGVDb2RlU2Nyb2xsIiwic2Nyb2xsVG9wIiwidXBkYXRlRGV2aWNlV2lkdGgiXSwibWFwcGluZ3MiOiJ1QkFlQSxhQUdJLFdBQW1CQSxHQUNmQyxLQUFLRCxVQUFZQSxFQThDekIsT0FyQ2lCLFlBQUFFLEtBQWIsVyw2bUNBQ0ksTUFBTyxDQUFQLEVBQU8sSUFBSUMsU0FBUSxTQUFDQyxFQUFTQyxHQUN6QixJQUFNQyxFQUFLLEVBQUtOLFVBQVVPLGFBQWEsZ0JBQzVCQyxJQUFQRixHQUNBRCxFQUFPLElBQUlJLE1BQ1Asd0RBSVIsSUFBTUMsRUFBTyxFQUFLVixVQUFVTyxhQUFhLGFBQzVCQyxJQUFURSxHQUNBTCxFQUFPLElBQUlJLE1BQ1AscURBS1IsSUFBSUUsRUFDQUMsU0FBU0MsZUFBZVAsR0FDUCxPQUFqQkssSUFNSkEsRUFBZUMsU0FBU0UsY0FBYyxXQUN6QkMsT0FBUyxXQUNsQlgsRUFBUU8sSUFFWkEsRUFBYUwsR0FBS0EsRUFDbEJLLEVBQWFLLElBQU1OLEVBRW5CLEVBQUtWLFVBQVVpQixXQUFXQyxhQUN0QlAsRUFBYyxFQUFLWCxVQUFVbUIsY0FiN0JmLEVBQVFPLFcsZ1NBaUJ4QixFQWxEQSxHLDYwQ0NnQ0EsYUFLSSxXQUFtQlMsR0FDZm5CLEtBQUttQixhQUFlQSxFQWlGNUIsT0E5RWlCLFlBQUFDLDJCQUFiLFNBQXdDQyxHLDhFQUNwQyxNQUFPLENBQVAsRUFBTyxJQUFJbkIsU0FBUSxTQUFDQyxFQUFTQyxHQUN6QixJQUFNVyxFQUFNLEVBQUtJLGFBQWFiLGFBQWFlLEdBQzNDLEdBQVksT0FBUk4sRUFPSixJQUFNTyxHQUFnQixJQUFJQyxNQUFNQyxlQUMzQnZCLEtBQUtjLEdBQUssV0FDUFUsUUFBUUMsSUFBSSx5QkFBeUJYLEdB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QXJFLE9BQU84QixpQkFBaUIsU0FBVXVDLEdBQW1CIiwiZmlsZSI6ImluZGV4Lm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQSBsYXp5IGxvYWRlciBmb3IgdGhlIFRIUkVFLmpzIHNjcmlwdC5cbiAqXG4gKiBVc2FnZTpcbiAqXG4gKiBgYGB0eXBlc2NyaXB0XG4gKiBjb25zdCBsaW5rRWxlbWVudCA9IDxIVE1MTGlua0VsZW1lbnQ+ZG9jdW1lbnRcbiAqICAgICAucXVlcnlTZWxlY3RvcignbGlua1tyZWw9XCJwYXJhbGxheC10aHJlZS1qc1wiXScpXG4gKiAvLyBUT0RPOiBDaGVjayBpZiBsaW5rRWxlbWVudCBhY3R1YWxseSBleGlzdHNcbiAqIGNvbnN0IGxvYWRlciA9IG5ldyBUaHJlZUxvYWRlcihsaW5rRWxlbWVudClcbiAqICAgICAubG9hZCgoKSA9PiB7XG4gKiAgICAgICAgIC8vIERvIHNvbWV0aGluZyBvbiBsb2FkXG4gKiAgICAgfSlcbiAqIGBgYFxuICovXG5leHBvcnQgY2xhc3MgVGhyZWVMb2FkZXIge1xuICAgIHByaXZhdGUgdGhyZWVMaW5rOiBIVE1MTGlua0VsZW1lbnRcblxuICAgIHB1YmxpYyBjb25zdHJ1Y3Rvcih0aHJlZUxpbms6IEhUTUxMaW5rRWxlbWVudCkge1xuICAgICAgICB0aGlzLnRocmVlTGluayA9IHRocmVlTGlua1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIExvYWQgVEhSRUUuanMgaW50byBhIHNjcmlwdCBlbGVtZW50LlxuICAgICAqXG4gICAgICogVGhlIHNjcmlwdCBlbGVtZW50IGlzIHBsYWNlZCBiZWxvdyB0aGUgZ2l2ZW4gbGluayBlbGVtZW50LlxuICAgICAqIFNlZSBpbmRleC50cyBmb3IgYSB1c2FnZSBleGFtcGxlLlxuICAgICAqL1xuICAgIHB1YmxpYyBhc3luYyBsb2FkKCk6IFByb21pc2U8SFRNTFNjcmlwdEVsZW1lbnQ+IHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGlkID0gdGhpcy50aHJlZUxpbmsuZ2V0QXR0cmlidXRlKCdkYXRhLWlkJylcbiAgICAgICAgICAgIGlmIChpZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcihcbiAgICAgICAgICAgICAgICAgICAgJ1RoZSBsaW5rIGVsZW1lbnQgaGFzIHRvIHN1cHBseSBhIGRhdGEtaWQgYXR0cmlidXRlISdcbiAgICAgICAgICAgICAgICApKVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBocmVmID0gdGhpcy50aHJlZUxpbmsuZ2V0QXR0cmlidXRlKCdocmVmJylcbiAgICAgICAgICAgIGlmIChocmVmID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICByZWplY3QobmV3IEVycm9yKFxuICAgICAgICAgICAgICAgICAgICAnVGhlIGxpbmsgZWxlbWVudCBoYXMgdG8gc3VwcGx5IGEgaHJlZiBhdHRyaWJ1dGUhJ1xuICAgICAgICAgICAgICAgICkpXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIENoZWNrIGlmIHRoZXJlIGlzIGFscmVhZHkgYSBUSFJFRS5qcyBzY3JpcHQgZWxlbWVudC5cbiAgICAgICAgICAgIGxldCB0aHJlZUVsZW1lbnQgPSA8SFRNTFNjcmlwdEVsZW1lbnQ+XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpXG4gICAgICAgICAgICBpZiAodGhyZWVFbGVtZW50ICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZSh0aHJlZUVsZW1lbnQpXG4gICAgICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIElmIG5vdCwgY3JlYXRlIGEgbmV3IG9uZS5cbiAgICAgICAgICAgIHRocmVlRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpXG4gICAgICAgICAgICB0aHJlZUVsZW1lbnQub25sb2FkID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIHJlc29sdmUodGhyZWVFbGVtZW50KVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhyZWVFbGVtZW50LmlkID0gaWRcbiAgICAgICAgICAgIHRocmVlRWxlbWVudC5zcmMgPSBocmVmXG4gICAgICAgICAgICAvLyBJbnNlcnQgVEhSRUUuanMgYWZ0ZXIgdGhlIGxpbmsgZWxlbWVudC5cbiAgICAgICAgICAgIHRoaXMudGhyZWVMaW5rLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKFxuICAgICAgICAgICAgICAgIHRocmVlRWxlbWVudCwgdGhpcy50aHJlZUxpbmsubmV4dFNpYmxpbmdcbiAgICAgICAgICAgIClcbiAgICAgICAgfSlcbiAgICB9XG59XG4iLCIvKipcbiAqIFRoZSBsYXppbHkgaW1wb3J0ZWQgVEhSRUUuanMgbGlicmFyeS5cbiAqXG4gKiBUSFJFRSBpcyBsb2FkZWQgbGF6aWx5IGFuZCBvbmx5IG9uIGRldmljZXMgZXhjZWVkaW5nIGEgZ2l2ZW5cbiAqIG1heGltdW0gd2lkdGguIEl0IHdpbGwgbm90IGJlIGluY2x1ZGVkIGFzIGEgbW9kdWxlIHRvIHJlZHVjZSB0aGVcbiAqIGZpbGUgc2l6ZSBvZiB0aGlzIHNjcmlwdC5cbiAqL1xuZGVjbGFyZSB2YXIgVEhSRUU6IGFueVxuXG4vKipcbiAqIFRoZSB2ZXJ0ZXggc2hhZGVyIGZvciB0aGUgVEhSRUUuanMgd2ViIGdsIHJlbmRlcmVyLlxuICovXG5jb25zdCB2ZXJ0ZXhTaGFkZXI6IFN0cmluZyA9IGBcbiAgICB2YXJ5aW5nIHZlYzIgdlV2O1xuXG4gICAgdm9pZCBtYWluKClcdHtcbiAgICAgICAgdlV2ID0gdXY7XG4gICAgICAgIGdsX1Bvc2l0aW9uID0gcHJvamVjdGlvbk1hdHJpeCAqIG1vZGVsVmlld01hdHJpeCAqIHZlYzQocG9zaXRpb24sIDEuMCk7XG4gICAgfVxuYFxuXG5cbi8qKlxuICogVGhlIGZyYWdtZW50IHNoYWRlciBmb3IgdGhlIFRIUkVFLmpzIHdlYiBnbCByZW5kZXJlci5cbiAqL1xuY29uc3QgZnJhZ21lbnRTaGFkZXI6IFN0cmluZyA9IGBcbiAgICAjZXh0ZW5zaW9uIEdMX09FU19zdGFuZGFyZF9kZXJpdmF0aXZlcyA6IGVuYWJsZVxuICAgIHZhcnlpbmcgdmVjMiB2VXY7XG4gICAgdW5pZm9ybSBmbG9hdCBtb3VzZVg7XG4gICAgdW5pZm9ybSBmbG9hdCBtb3VzZVk7XG4gICAgdW5pZm9ybSBmbG9hdCBzY3JvbGxPZmZzZXQ7XG4gICAgdW5pZm9ybSBzYW1wbGVyMkQgZGVwdGhUZXh0dXJlO1xuICAgIHVuaWZvcm0gc2FtcGxlcjJEIHRleHR1cmU7XG4gICAgdm9pZCBtYWluKCkge1xuICAgICAgICB2ZWMyIHZNb3VzZSA9IHZlYzIobW91c2VYLCBtb3VzZVkpO1xuICAgICAgICB2ZWMyIHZTY3JvbGxPZmZzZXQgPSB2ZWMyKDAsIHNjcm9sbE9mZnNldCk7XG4gICAgICAgIGZsb2F0IGRlcHRoID0gdGV4dHVyZTJEKGRlcHRoVGV4dHVyZSwgdlV2KS5yO1xuICAgICAgICBnbF9GcmFnQ29sb3IgPSB0ZXh0dXJlMkQoXG4gICAgICAgICAgICB0ZXh0dXJlLCB2VXYgKyB2TW91c2UgKiAoZGVwdGgpICsgdlNjcm9sbE9mZnNldFxuICAgICAgICApO1xuICAgICAgICAvLyBEbyBzb21lIGVkZ2UgYW50aSBhbGlhc2luZywgYmVjYXVzZSB0aGUgaW1hZ2VcbiAgICAgICAgLy8gbWF5IGNvbnRhaW4gYSBwcmVtdWx0aXBsaWVkIGFscGhhIGNoYW5uZWwuXG4gICAgICAgIGdsX0ZyYWdDb2xvci5yZ2IgPSBnbF9GcmFnQ29sb3IucmdiICogZ2xfRnJhZ0NvbG9yLmE7XG4gICAgfVxuYFxuXG5cbmV4cG9ydCBjbGFzcyBQYXJhbGxheEltYWdlIHtcbiAgICBpbWFnZUVsZW1lbnQ6IEhUTUxJbWFnZUVsZW1lbnRcblxuICAgIHBhcmFsbGF4U2NlbmU/OiBQYXJhbGxheFNjZW5lXG5cbiAgICBwdWJsaWMgY29uc3RydWN0b3IoaW1hZ2VFbGVtZW50OiBIVE1MSW1hZ2VFbGVtZW50KSB7XG4gICAgICAgIHRoaXMuaW1hZ2VFbGVtZW50ID0gaW1hZ2VFbGVtZW50XG4gICAgfVxuXG4gICAgcHVibGljIGFzeW5jIGxvYWRUZXh0dXJlQmVoaW5kQXR0cmlidXRlKGF0dHJpYnV0ZTogc3RyaW5nKTogUHJvbWlzZTxhbnk+IHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHNyYyA9IHRoaXMuaW1hZ2VFbGVtZW50LmdldEF0dHJpYnV0ZShhdHRyaWJ1dGUpXG4gICAgICAgICAgICBpZiAoc3JjID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcihgXG4gICAgICAgICAgICAgICAgICAgIFRoZSBpbWFnZSBlbGVtZW50IG11c3QgaW5jbHVkZVxuICAgICAgICAgICAgICAgICAgICBhbiBhdHRyaWJ1dGUgXCIke2F0dHJpYnV0ZX1cIiFcbiAgICAgICAgICAgICAgICBgKSlcbiAgICAgICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHRleHR1cmVMb2FkZXIgPSBuZXcgVEhSRUUuVGV4dHVyZUxvYWRlcigpXG4gICAgICAgICAgICAgICAgLmxvYWQoc3JjLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBMb2FkZWQgaW1hZ2UgcmVzb3VyY2UgJHtzcmN9YClcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh0ZXh0dXJlTG9hZGVyKVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgfVxuXG5cbiAgICBwdWJsaWMgYXN5bmMgbG9hZCgpIHtcbiAgICAgICAgaWYgKHRoaXMucGFyYWxsYXhTY2VuZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm5cbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHdpZHRoID0gdGhpcy5pbWFnZUVsZW1lbnQuY2xpZW50V2lkdGhcbiAgICAgICAgY29uc3QgaGVpZ2h0ID0gdGhpcy5pbWFnZUVsZW1lbnQuY2xpZW50SGVpZ2h0XG4gICAgICAgIGNvbnN0IGNhbWVyYSA9IG5ldyBUSFJFRS5QZXJzcGVjdGl2ZUNhbWVyYShcbiAgICAgICAgICAgIDQ1LCB3aWR0aCAvIGhlaWdodCwgMSwgMTAwMFxuICAgICAgICApXG4gICAgICAgIGNhbWVyYS5wb3NpdGlvbi56ID0gMjAwXG4gICAgICAgIGNvbnN0IGRpZmZ1c2VUZXh0dXJlTG9hZGVyID0gYXdhaXQgdGhpc1xuICAgICAgICAgICAgLmxvYWRUZXh0dXJlQmVoaW5kQXR0cmlidXRlKCdzcmMnKVxuICAgICAgICBjb25zdCBkZXB0aFRleHR1cmVMb2FkZXIgPSBhd2FpdCB0aGlzXG4gICAgICAgICAgICAubG9hZFRleHR1cmVCZWhpbmRBdHRyaWJ1dGUoJ2RhdGEtcGFyYWxsYXgtZGVwdGgtbWFwJylcbiAgICAgICAgY29uc3QgcmVuZGVyZXIgPSBuZXcgVEhSRUUuV2ViR0xSZW5kZXJlcih7XG4gICAgICAgICAgICBhbnRpYWxpYXM6IHRydWUsXG4gICAgICAgICAgICBhbHBoYTogdHJ1ZVxuICAgICAgICB9KVxuICAgICAgICByZW5kZXJlci5zZXRTaXplKHdpZHRoLCBoZWlnaHQpXG4gICAgICAgIGNvbnN0IGNhbnZhcyA9IHJlbmRlcmVyLmRvbUVsZW1lbnRcbiAgICAgICAgY29uc3Qgc2hhZGVyTWF0ZXJpYWwgPSBuZXcgVEhSRUUuU2hhZGVyTWF0ZXJpYWwoe1xuICAgICAgICAgICAgdW5pZm9ybXM6IHtcbiAgICAgICAgICAgICAgICBtb3VzZVg6IHt2YWx1ZTogMH0sXG4gICAgICAgICAgICAgICAgbW91c2VZOiB7dmFsdWU6IDB9LFxuICAgICAgICAgICAgICAgIHNjcm9sbE9mZnNldDoge3ZhbHVlOiAwfSxcbiAgICAgICAgICAgICAgICB0ZXh0dXJlOiB7dmFsdWU6IGRpZmZ1c2VUZXh0dXJlTG9hZGVyfSxcbiAgICAgICAgICAgICAgICBkZXB0aFRleHR1cmU6IHt2YWx1ZTogZGVwdGhUZXh0dXJlTG9hZGVyfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB2ZXJ0ZXhTaGFkZXIsXG4gICAgICAgICAgICBmcmFnbWVudFNoYWRlclxuICAgICAgICB9KVxuICAgICAgICBjb25zdCBzY2VuZSA9IG5ldyBUSFJFRS5TY2VuZSgpXG4gICAgICAgIGNvbnN0IGdlb21ldHJ5ID0gbmV3IFRIUkVFLlBsYW5lQnVmZmVyR2VvbWV0cnkoMSwgMSlcbiAgICAgICAgY29uc3QgbWVzaCA9IG5ldyBUSFJFRS5NZXNoKGdlb21ldHJ5LCBzaGFkZXJNYXRlcmlhbClcbiAgICAgICAgc2NlbmUuYWRkKG1lc2gpXG5cbiAgICAgICAgdGhpcy5wYXJhbGxheFNjZW5lID0gbmV3IFBhcmFsbGF4U2NlbmUoXG4gICAgICAgICAgICB0aGlzLmltYWdlRWxlbWVudCxcbiAgICAgICAgICAgIGNhbnZhcyxcbiAgICAgICAgICAgIGNhbWVyYSxcbiAgICAgICAgICAgIHJlbmRlcmVyLFxuICAgICAgICAgICAgZGlmZnVzZVRleHR1cmVMb2FkZXIsXG4gICAgICAgICAgICBkZXB0aFRleHR1cmVMb2FkZXIsXG4gICAgICAgICAgICBzaGFkZXJNYXRlcmlhbCxcbiAgICAgICAgICAgIHNjZW5lLFxuICAgICAgICAgICAgZ2VvbWV0cnksXG4gICAgICAgICAgICBtZXNoXG4gICAgICAgIClcbiAgICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgcHVibGljIHNob3coKTogdm9pZCB7XG4gICAgICAgIHRoaXMucGFyYWxsYXhTY2VuZT8uc2hvdygpXG4gICAgfVxuXG4gICAgcHVibGljIGhpZGUoKTogdm9pZCB7XG4gICAgICAgIHRoaXMucGFyYWxsYXhTY2VuZT8uaGlkZSgpXG4gICAgfVxufVxuXG5cbmNsYXNzIFBhcmFsbGF4U2NlbmUge1xuICAgIGltYWdlOiBIVE1MSW1hZ2VFbGVtZW50XG4gICAgY2FudmFzOiBIVE1MQ2FudmFzRWxlbWVudFxuICAgIGNhbWVyYTogYW55XG4gICAgcmVuZGVyZXI6IGFueVxuICAgIGRpZmZ1c2VUZXh0dXJlTG9hZGVyOiBhbnlcbiAgICBkZXB0aFRleHR1cmVMb2FkZXI6IGFueVxuICAgIHNoYWRlck1hdGVyaWFsOiBhbnlcbiAgICBzY2VuZTogYW55XG4gICAgZ2VvbWV0cnk6IGFueVxuICAgIG1lc2g6IGFueVxuXG4gICAgcHVibGljIGNvbnN0cnVjdG9yKFxuICAgICAgICBpbWFnZTogSFRNTEltYWdlRWxlbWVudCxcbiAgICAgICAgY2FudmFzOiBIVE1MQ2FudmFzRWxlbWVudCxcbiAgICAgICAgY2FtZXJhOiBhbnksXG4gICAgICAgIHJlbmRlcmVyOiBhbnksXG4gICAgICAgIGRpZmZ1c2VUZXh0dXJlTG9hZGVyOiBhbnksXG4gICAgICAgIGRlcHRoVGV4dHVyZUxvYWRlcjogYW55LFxuICAgICAgICBzaGFkZXJNYXRlcmlhbDogYW55LFxuICAgICAgICBzY2VuZTogYW55LFxuICAgICAgICBnZW9tZXRyeTogYW55LFxuICAgICAgICBtZXNoOiBhbnlcbiAgICApIHtcbiAgICAgICAgdGhpcy5pbWFnZSA9IGltYWdlXG4gICAgICAgIHRoaXMuY2FudmFzID0gY2FudmFzXG4gICAgICAgIHRoaXMuY2FtZXJhID0gY2FtZXJhXG4gICAgICAgIHRoaXMucmVuZGVyZXIgPSByZW5kZXJlclxuICAgICAgICB0aGlzLmRpZmZ1c2VUZXh0dXJlTG9hZGVyID0gZGlmZnVzZVRleHR1cmVMb2FkZXJcbiAgICAgICAgdGhpcy5kZXB0aFRleHR1cmVMb2FkZXIgPSBkZXB0aFRleHR1cmVMb2FkZXJcbiAgICAgICAgdGhpcy5zaGFkZXJNYXRlcmlhbCA9IHNoYWRlck1hdGVyaWFsXG4gICAgICAgIHRoaXMuc2NlbmUgPSBzY2VuZVxuICAgICAgICB0aGlzLmdlb21ldHJ5ID0gZ2VvbWV0cnlcbiAgICAgICAgdGhpcy5tZXNoID0gbWVzaFxuICAgIH1cblxuICAgIHByaXZhdGUgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCk6IHZvaWQge1xuICAgICAgICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIucmVuZGVyKHRoaXMuc2NlbmUsIHRoaXMuY2FtZXJhKVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIHByaXZhdGUgdXBkYXRlVmlld3BvcnRBc3BlY3RSYXRpbygpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5jYW1lcmEuYXNwZWN0ID1cbiAgICAgICAgICAgIHRoaXMuaW1hZ2UubmF0dXJhbFdpZHRoIC8gdGhpcy5pbWFnZS5uYXR1cmFsSGVpZ2h0XG4gICAgICAgIHRoaXMuY2FtZXJhLnVwZGF0ZVByb2plY3Rpb25NYXRyaXgoKVxuICAgICAgICBjb25zdCB2Rk9WID0gVEhSRUUuTWF0aC5kZWdUb1JhZCh0aGlzLmNhbWVyYS5mb3YpXG4gICAgICAgIGNvbnN0IG1heEhlaWdodCA9IDIgKiBNYXRoLnRhbih2Rk9WIC8gMikgKiB0aGlzLmNhbWVyYS5wb3NpdGlvbi56XG4gICAgICAgIGNvbnN0IGltYWdlQXNwZWN0ID1cbiAgICAgICAgICAgIHRoaXMuaW1hZ2UubmF0dXJhbEhlaWdodCAvIHRoaXMuaW1hZ2UubmF0dXJhbFdpZHRoXG4gICAgICAgIGNvbnN0IGhlaWdodCA9IG1heEhlaWdodFxuICAgICAgICBjb25zdCB3aWR0aCA9IG1heEhlaWdodCAqIGltYWdlQXNwZWN0XG4gICAgICAgIHRoaXMubWVzaC5zY2FsZS5zZXQod2lkdGgsIGhlaWdodCwgMSlcbiAgICAgICAgdGhpcy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKVxuICAgIH1cblxuICAgIHByaXZhdGUgcmVhY3RUb01vdXNlTW92ZShldmVudDogTW91c2VFdmVudCk6IHZvaWQge1xuICAgICAgICBjb25zdCByZWN0ID0gdGhpcy5jYW52YXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KClcbiAgICAgICAgY29uc3QgeCA9IE1hdGgubWF4KC01MDAsIE1hdGgubWluKDUwMCwgZXZlbnQuY2xpZW50WCAtIHJlY3QubGVmdCkpXG4gICAgICAgIGNvbnN0IHkgPSBNYXRoLm1heCgtNTAwLCBNYXRoLm1pbig1MDAsIGV2ZW50LmNsaWVudFkgLSByZWN0LnRvcCkpXG4gICAgICAgIHRoaXMuc2hhZGVyTWF0ZXJpYWwudW5pZm9ybXMubW91c2VYLnZhbHVlID0gLXggLyAxNTAwMFxuICAgICAgICB0aGlzLnNoYWRlck1hdGVyaWFsLnVuaWZvcm1zLm1vdXNlWS52YWx1ZSA9IHkgLyAxNTAwMFxuICAgICAgICB0aGlzLmNhbnZhcy5zdHlsZS50cmFuc2Zvcm0gPSBgcm90YXRlM2QoMCwgMSwgMSwgJHt4IC8gNTB9ZGVnKWBcbiAgICAgICAgdGhpcy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKVxuICAgIH1cblxuICAgIHB1YmxpYyBzaG93KCk6IHZvaWQge1xuICAgICAgICB0aGlzLmNhbnZhcy5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJ1xuICAgICAgICB0aGlzLmltYWdlLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSdcbiAgICAgICAgaWYgKHRoaXMuY2FudmFzLnBhcmVudE5vZGUgPT09IG51bGwpIHtcbiAgICAgICAgICAgIHRoaXMuaW1hZ2UucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoXG4gICAgICAgICAgICAgICAgdGhpcy5jYW52YXMsIHRoaXMuaW1hZ2UubmV4dFNpYmxpbmdcbiAgICAgICAgICAgIClcbiAgICAgICAgICAgIHRoaXMucmVuZGVyZXIuc2V0U2l6ZShcbiAgICAgICAgICAgICAgICB0aGlzLmNhbnZhcy5jbGllbnRXaWR0aCxcbiAgICAgICAgICAgICAgICB0aGlzLmNhbnZhcy5jbGllbnRIZWlnaHRcbiAgICAgICAgICAgIClcbiAgICAgICAgfVxuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgICAgICAgICdyZXNpemUnLFxuICAgICAgICAgICAgdGhpcy51cGRhdGVWaWV3cG9ydEFzcGVjdFJhdGlvLmJpbmQodGhpcyksXG4gICAgICAgICAgICB0cnVlXG4gICAgICAgIClcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgICAgICAgICdtb3VzZW1vdmUnLFxuICAgICAgICAgICAgdGhpcy5yZWFjdFRvTW91c2VNb3ZlLmJpbmQodGhpcyksXG4gICAgICAgICAgICB0cnVlXG4gICAgICAgIClcbiAgICAgICAgdGhpcy51cGRhdGVWaWV3cG9ydEFzcGVjdFJhdGlvKClcbiAgICAgICAgdGhpcy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKVxuICAgIH1cblxuICAgIHB1YmxpYyBoaWRlKCk6IHZvaWQge1xuICAgICAgICB0aGlzLmltYWdlLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snXG4gICAgICAgIHRoaXMuY2FudmFzLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSdcbiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXG4gICAgICAgICAgICAncmVzaXplJyxcbiAgICAgICAgICAgIHRoaXMudXBkYXRlVmlld3BvcnRBc3BlY3RSYXRpby5iaW5kKHRoaXMpLFxuICAgICAgICAgICAgdHJ1ZVxuICAgICAgICApXG4gICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXG4gICAgICAgICAgICAnbW91c2Vtb3ZlJyxcbiAgICAgICAgICAgIHRoaXMucmVhY3RUb01vdXNlTW92ZS5iaW5kKHRoaXMpLFxuICAgICAgICAgICAgdHJ1ZVxuICAgICAgICApXG4gICAgfVxufVxuIiwiLyoqXG4gKiBBdXRob3I6IFBoaWxpcHAgTWF0dGhlc1xuICpcbiAqIFRoaXMgbW9kdWxlIGlzIHVzZWQgZm9yIGEgcGFyYWxsYXggZWZmZWN0IG9uIGltYWdlcy5cbiAqXG4gKiBJdCB1c2VzIFRIUkVFLmpzIChodHRwczovL3RocmVlanMub3JnLykgb24gYSBjYW52YXNcbiAqIHRvZ2V0aGVyIHdpdGggYW4gaW1hZ2UgYW5kIGEgZGVwdGggbWFwIHRvIGFwcGx5XG4gKiBwYXJhbGxheCBvY2NsdXNpb24gbWFwcGluZywgc2ltaWxhciB0byB0aGVcbiAqIDNEaWZ5IGFwcCAoaHR0cHM6Ly9naXRodWIuY29tLzNkaWZ5LWFwcCkuXG4gKlxuICogVXNhZ2U6XG4gKlxuICogYGBgaHRtbFxuICogPCEtLSBTb21ld2hlcmUgaW4geW91ciBodG1sIC0tIT5cbiAqIDxpbWcgLi4uIHNyYz1cInBhdGgvdG8vcHJldmlldy53ZWJwXCJcbiAqICAgICAgICAgIGNsYXNzPVwicGFyYWxsYXhcIlxuICogICAgICAgICAgZGF0YS1wYXJhbGxheC1kZXB0aC1tYXA9XCJwYXRoL3RvL3ByZXZpZXctZGVwdGgud2VicFwiPlxuICogPCEtLSBQcmVmZXJhYmx5IGF0IHRoZSBib3R0b20gb2YgeW91ciBib2R5IGVsZW1lbnQgLS0hPlxuICogPGxpbmsgcmVsPVwicGFyYWxsYXgtdGhyZWUtanNcIlxuICogICAgICAgaHJlZj1cInBhdGgvdG8vdGhyZWUubWluLmpzXCJcbiAqICAgICAgIGRhdGEtaWQ9XCJpZC1vZi10aGUtbGF6eWxvYWRlZC10aHJlZS1zY3JpcHQtZWxlbWVudFwiPlxuICogPCEtLSBUSFJFRS5qcyB3aWxsIGJlIGxvYWRlZCBsYXppbHkgdG8gdGhpcyBsb2NhdGlvbiAtLSE+XG4gKiBgYGBcbiAqXG4gKiBOb3RlczpcbiAqIC0gVGhlIHNyY3NldCBhdHRyaWJ1dGUgaXMgbm90IHN1cHBvcnRlZC5cbiAqIC0gVGhlIGltYWdlIGVsZW1lbnQgZ2V0cyBsYXppbHkgcmVwbGFjZWQgKG9ubHkgb24gZGV2aWNlc1xuICogd2lkZXIgdGhhbiAxMDIzIHBpeGVscykgYnkgYSBjYW52YXMgd2hpY2ggd2lsbCByZW5kZXIgYVxuICogVEhSRUUuanMgcGFyYWxsYXggc2NlbmUgd2l0aCB0aGUgZ2l2ZW4gZGVwdGggbWFwLlxuICogLSBUSFJFRS5qcyBhbmQgdGhlIHBhcmFsbGF4IGVmZmVjdCBpcyBvbmx5IGxvYWRlZCwgd2hlbiB0aGVcbiAqIHNjcmVlbiBleGNlZWRzIG1vYmlsZSBkZXZpY2Ugd2lkdGggb2YgMTAyMyBwaXhlbHMuIFRoaXMgYWxzb1xuICogYXBwbGllcyB0byBzY3JlZW4gcmVzaXppbmcgZXZlbnRzIGFuZCBub3Qgb25seSB0aGUgaW5pdGlhbFxuICogcGFnZSBsb2FkLlxuICovXG5cblxuaW1wb3J0IHsgVGhyZWVMb2FkZXIgfSBmcm9tICcuL2xvYWRlcidcbmltcG9ydCB7IFBhcmFsbGF4SW1hZ2UgfSBmcm9tICcuL2ltYWdlJ1xuXG5cbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsIGFzeW5jICgpID0+IHtcbiAgICBjb25zdCB0aHJlZUxpbmsgPSA8SFRNTExpbmtFbGVtZW50PmRvY3VtZW50XG4gICAgICAgIC5xdWVyeVNlbGVjdG9yKCdsaW5rW3JlbD1cInBhcmFsbGF4LXRocmVlLWpzXCJdJylcblxuICAgIGNvbnN0IHRocmVlTG9hZGVyID0gbmV3IFRocmVlTG9hZGVyKHRocmVlTGluaylcbiAgICBjb25zdCBwYXJhbGxheEltYWdlRWxlbWVudHMgPSBkb2N1bWVudFxuICAgICAgICAucXVlcnlTZWxlY3RvckFsbDxIVE1MSW1hZ2VFbGVtZW50PignaW1nLnBhcmFsbGF4JylcbiAgICBjb25zdCBwYXJhbGxheEltYWdlcyA9IEFycmF5LmZyb20ocGFyYWxsYXhJbWFnZUVsZW1lbnRzKVxuICAgICAgICAubWFwKChlbGVtZW50KSA9PiBuZXcgUGFyYWxsYXhJbWFnZShlbGVtZW50KSlcblxuICAgIGNvbnN0IHVwZGF0ZVdpbmRvd0RpbWVuc2lvbnMgPSBhc3luYyAoKSA9PiB7XG4gICAgICAgIGlmIChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGggPCAxMDIzKSB7XG4gICAgICAgICAgICBmb3IgKGxldCBwYXJhbGxheEltYWdlIG9mIHBhcmFsbGF4SW1hZ2VzKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0hpZGluZyBwYXJhbGxheCBpbWFnZS4uLicpXG4gICAgICAgICAgICAgICAgcGFyYWxsYXhJbWFnZS5oaWRlKClcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdMb2FkaW5nIFRIUkVFLmpzLi4uJylcbiAgICAgICAgICAgIGF3YWl0IHRocmVlTG9hZGVyLmxvYWQoKVxuICAgICAgICAgICAgZm9yIChsZXQgcGFyYWxsYXhJbWFnZSBvZiBwYXJhbGxheEltYWdlcykge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdMb2FkaW5nIHBhcmFsbGF4IGltYWdlLi4uJylcbiAgICAgICAgICAgICAgICBhd2FpdCBwYXJhbGxheEltYWdlLmxvYWQoKVxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTaG93aW5nIHBhcmFsbGF4IGltYWdlLi4uJylcbiAgICAgICAgICAgICAgICBwYXJhbGxheEltYWdlLnNob3coKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgYXdhaXQgdXBkYXRlV2luZG93RGltZW5zaW9ucygpXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHVwZGF0ZVdpbmRvd0RpbWVuc2lvbnMsIGZhbHNlKVxufSlcblxuIiwiZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgZnVuY3Rpb24oZXZlbnQpIHtcbiAgY29uc3QgbWFjYm9va0NvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWNib29rLWNvbnRhaW5lcicpO1xuICBjb25zdCBtYWNib29rQ29kZUNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWNib29rLWNvZGUtY29udGFpbmVyJyk7XG4gIGNvbnN0IHByZXZpZXcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGVlcmJyaWRnZS1hbmltYXRpb24tcHJldmlldycpO1xuICBjb25zdCBjYW52YXMgPSA8SFRNTENhbnZhc0VsZW1lbnQ+IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwZWVyYnJpZGdlLWFuaW1hdGlvbicpO1xuICBjb25zdCBjdHggPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcblxuICBjb25zdCBoZWlnaHQgPSBjYW52YXMud2lkdGggKiAoMjU0MSAvIDIyMjUpO1xuICBjYW52YXMuaGVpZ2h0ID0gaGVpZ2h0O1xuXG4gIGNvbnN0IGZyYW1lID0gbmV3IEltYWdlKCk7XG4gIGZyYW1lLm9ubG9hZCA9IGZ1bmN0aW9uKCkge1xuICAgIGN0eC5jbGVhclJlY3QoMCwwLGNhbnZhcy53aWR0aCxjYW52YXMuaGVpZ2h0KVxuICAgIGN0eC5kcmF3SW1hZ2UoZnJhbWUsIDAsIDAsIGZyYW1lLndpZHRoLCBmcmFtZS5oZWlnaHQsIC8vIHNvdXJjZSByZWN0YW5nbGVcbiAgICAgICAgICAgICAgICAgIDAsIDAsIGNhbnZhcy53aWR0aCwgY2FudmFzLmhlaWdodCk7IC8vIGRlc3RpbmF0aW9uIHJlY3RhbmdsZVxuICB9XG5cbiAgZnVuY3Rpb24gZnJhbWVVUkwoaW5kZXg6IE51bWJlcikge1xuICAgIHJldHVybiBgL3N0YXRpYy9pbWcvcGVlcmJyaWRnZS1hbmltYXRpb24vYW5pbWF0aW9uLTEwMDBfJHtpbmRleH0ud2VicGA7XG4gIH1cblxuICBsZXQgaGFzUHJlbG9hZGVkRnJhbWVzID0gZmFsc2U7XG5cbiAgZnVuY3Rpb24gdXBkYXRlQ3VycmVudFBlZXJicmlkZ2VGcmFtZSgpIHtcbiAgICBjb25zdCByZWN0ID0gY2FudmFzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgIGNvbnN0IHByb2dyZXNzID0gMSAtIChyZWN0LnkgKyB3aW5kb3cuaW5uZXJIZWlnaHQpIC8gKHJlY3QuaGVpZ2h0ICsgd2luZG93LmlubmVySGVpZ2h0KTtcbiAgICBpZiAocHJvZ3Jlc3MgPiAxIHx8IHByb2dyZXNzIDwgMCkgcmV0dXJuO1xuICAgIGNvbnN0IG51bWJlck9mRnJhbWVzID0gMTIwIC0gMzg7XG4gICAgaWYgKCFoYXNQcmVsb2FkZWRGcmFtZXMpIHtcbiAgICAgIGZvciAobGV0IGkgPSAzODsgaSA8PSAxMjA7IGkrKykge1xuICAgICAgICBuZXcgUHJvbWlzZShyID0+IHtcbiAgICAgICAgICB2YXIgaW1hZ2UgPSBuZXcgSW1hZ2UoKTtcbiAgICAgICAgICBpbWFnZS5vbmxvYWQgPSByO1xuICAgICAgICAgIGltYWdlLm9uZXJyb3IgPSByO1xuICAgICAgICAgIGltYWdlLnNyYyA9IGZyYW1lVVJMKGkpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGhhc1ByZWxvYWRlZEZyYW1lcyA9IHRydWU7XG4gICAgfVxuICAgIGNvbnN0IGZyYW1lSW5kZXggPSAzOCArIE1hdGgucm91bmQocHJvZ3Jlc3MgKiBudW1iZXJPZkZyYW1lcyk7XG4gICAgZnJhbWUuc3JjID0gZnJhbWVVUkwoZnJhbWVJbmRleCk7XG4gIH1cblxuICBmdW5jdGlvbiB1cGRhdGVDb2RlU2Nyb2xsKCkge1xuICAgIGNvbnN0IHJlY3QgPSBtYWNib29rQ29udGFpbmVyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgIGNvbnN0IHByb2dyZXNzID0gMSAtIChyZWN0LnkgKyB3aW5kb3cuaW5uZXJIZWlnaHQpIC8gKHJlY3QuaGVpZ2h0ICsgd2luZG93LmlubmVySGVpZ2h0KTtcbiAgICBpZiAocHJvZ3Jlc3MgPiAxIHx8IHByb2dyZXNzIDwgMCkgcmV0dXJuO1xuICAgIG1hY2Jvb2tDb2RlQ29udGFpbmVyLnNjcm9sbFRvcCA9IHByb2dyZXNzICogMTAwMDtcbiAgfVxuXG4gIGZ1bmN0aW9uIHVwZGF0ZURldmljZVdpZHRoKCkge1xuICAgIGlmIChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGggPCAxMDIzKSB7XG4gICAgICBjYW52YXMuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICAgIHByZXZpZXcuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgdXBkYXRlQ3VycmVudFBlZXJicmlkZ2VGcmFtZSwgdHJ1ZSk7XG5cbiAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdzY3JvbGwnLCB1cGRhdGVDb2RlU2Nyb2xsLCB0cnVlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcHJldmlldy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgICAgY2FudmFzLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgICAgdXBkYXRlQ3VycmVudFBlZXJicmlkZ2VGcmFtZSgpO1xuICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIHVwZGF0ZUN1cnJlbnRQZWVyYnJpZGdlRnJhbWUsIHRydWUpO1xuICAgICAgdXBkYXRlQ29kZVNjcm9sbCgpO1xuICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIHVwZGF0ZUNvZGVTY3JvbGwsIHRydWUpO1xuICAgIH1cbiAgfVxuXG4gIHVwZGF0ZURldmljZVdpZHRoKCk7XG4gIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCB1cGRhdGVEZXZpY2VXaWR0aCwgZmFsc2UpO1xufSk7XG4iXSwic291cmNlUm9vdCI6IiJ9